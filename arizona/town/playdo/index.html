<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Poste de Travail Plaidoyer Citoyen - Outil d'Ã©ducation populaire pour construire et mener des campagnes de plaidoyer">
    <meta name="theme-color" content="#1a365d">
    <title>Plaidoyer Citoyen â€” Poste de Travail v3</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiUGxhaWRveWVyIENpdG95ZW4iLCJzaG9ydF9uYW1lIjoiUGxhaWRveWVyIiwic3RhcnRfdXJsIjoiLiIsImRpc3BsYXkiOiJzdGFuZGFsb25lIiwiYmFja2dyb3VuZF9jb2xvciI6IiMxYTM2NWQiLCJ0aGVtZV9jb2xvciI6IiMxYTM2NWQiLCJpY29ucyI6W3sic3JjIjoiZGF0YTppbWFnZS9zdmcreG1sLDxzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2aWV3Qm94PScwIDAgMTAwIDEwMCc+PHJlY3QgZmlsbD0nJTIzMWEzNjVkJyB3aWR0aD0nMTAwJyBoZWlnaHQ9JzEwMCcgcng9JzIwJy8+PHRleHQgeD0nNTAnIHk9JzY1JyBmb250LXNpemU9JzUwJyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyBmaWxsPSd3aGl0ZSc+4pqWPC90ZXh0Pjwvc3ZnPiIsInNpemVzIjoiNTEyeDUxMiIsInR5cGUiOiJpbWFnZS9zdmcreG1sIn1dfQ==">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bitter:wght@400;500;600;700&family=Source+Sans+3:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>
    <script src="https://unpkg.com/docx@8.5.0/build/index.js"></script>
    
    <style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DESIGN SYSTEM â€” Plaidoyer Citoyen v3
   InspirÃ© de l'identitÃ© visuelle Justice et Paix
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
    /* Palette principale - Tons institutionnels */
    --primary-900: #1a365d;
    --primary-800: #234876;
    --primary-700: #2c5a8f;
    --primary-600: #3572b0;
    --primary-500: #4a90d9;
    --primary-400: #7eb3e8;
    --primary-300: #a8cef0;
    --primary-200: #d1e6f7;
    --primary-100: #eef6fc;
    
    /* Accent - Or/Bronze (inspiration Justice et Paix) */
    --accent-600: #b7791f;
    --accent-500: #d69e2e;
    --accent-400: #ecc94b;
    --accent-300: #f6e05e;
    --accent-200: #faf089;
    
    /* SÃ©mantique */
    --success-600: #2f855a;
    --success-500: #48bb78;
    --success-100: #c6f6d5;
    --warning-600: #c05621;
    --warning-500: #ed8936;
    --warning-100: #feebc8;
    --danger-600: #c53030;
    --danger-500: #f56565;
    --danger-100: #fed7d7;
    
    /* Neutres */
    --gray-900: #1a202c;
    --gray-800: #2d3748;
    --gray-700: #4a5568;
    --gray-600: #718096;
    --gray-500: #a0aec0;
    --gray-400: #cbd5e0;
    --gray-300: #e2e8f0;
    --gray-200: #edf2f7;
    --gray-100: #f7fafc;
    --gray-50: #fafbfc;
    --white: #ffffff;
    
    /* Fond application */
    --bg-app: var(--gray-100);
    --bg-sidebar: var(--primary-900);
    --bg-card: var(--white);
    --bg-input: var(--gray-50);
    
    /* Texte */
    --text-primary: var(--gray-900);
    --text-secondary: var(--gray-600);
    --text-muted: var(--gray-500);
    --text-inverse: var(--white);
    
    /* Bordures */
    --border-light: var(--gray-200);
    --border-default: var(--gray-300);
    --border-strong: var(--gray-400);
    
    /* Ombres */
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    
    /* Rayons */
    --radius-sm: 4px;
    --radius-md: 8px;
    --radius-lg: 12px;
    --radius-xl: 16px;
    
    /* Transitions */
    --transition-fast: 150ms ease;
    --transition-base: 250ms ease;
    --transition-slow: 400ms ease;
    
    /* Layout */
    --sidebar-width: 260px;
    --header-height: 60px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESET & BASE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
*, *::before, *::after {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html {
    font-size: 16px;
    scroll-behavior: smooth;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

body {
    font-family: 'Source Sans 3', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background: var(--bg-app);
    color: var(--text-primary);
    line-height: 1.6;
    min-height: 100vh;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LAYOUT PRINCIPAL
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.app {
    display: flex;
    min-height: 100vh;
}

/* Sidebar */
.sidebar {
    width: var(--sidebar-width);
    background: var(--bg-sidebar);
    color: var(--text-inverse);
    display: flex;
    flex-direction: column;
    position: fixed;
    left: 0;
    top: 0;
    bottom: 0;
    z-index: 100;
    overflow-y: auto;
    transition: transform var(--transition-base);
}

.sidebar-header {
    padding: 1.5rem;
    border-bottom: 1px solid rgba(255,255,255,0.1);
}

.sidebar-logo {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    text-decoration: none;
    color: inherit;
}

.sidebar-logo-icon {
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, var(--accent-500), var(--accent-600));
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.25rem;
}

.sidebar-logo-text {
    font-family: 'Bitter', Georgia, serif;
    font-weight: 700;
    font-size: 1.1rem;
    line-height: 1.2;
}

.sidebar-logo-sub {
    font-size: 0.7rem;
    font-weight: 400;
    opacity: 0.7;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

/* Navigation */
.sidebar-nav {
    flex: 1;
    padding: 1rem 0;
    overflow-y: auto;
}

.nav-section {
    margin-bottom: 1.5rem;
}

.nav-section-title {
    padding: 0.5rem 1.5rem;
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: rgba(255,255,255,0.5);
}

.nav-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.6rem 1.5rem;
    color: rgba(255,255,255,0.8);
    text-decoration: none;
    font-size: 0.9rem;
    transition: all var(--transition-fast);
    cursor: pointer;
    border: none;
    background: none;
    width: 100%;
    text-align: left;
}

.nav-item:hover {
    background: rgba(255,255,255,0.1);
    color: var(--white);
}

.nav-item.active {
    background: rgba(255,255,255,0.15);
    color: var(--white);
    border-left: 3px solid var(--accent-500);
}

.nav-item-icon {
    width: 20px;
    text-align: center;
    flex-shrink: 0;
}

/* Progress dans sidebar */
.sidebar-progress {
    padding: 1rem 1.5rem;
    border-top: 1px solid rgba(255,255,255,0.1);
}

.progress-label {
    display: flex;
    justify-content: space-between;
    font-size: 0.75rem;
    margin-bottom: 0.5rem;
    opacity: 0.8;
}

.progress-bar {
    height: 6px;
    background: rgba(255,255,255,0.2);
    border-radius: 3px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent-500), var(--success-500));
    border-radius: 3px;
    transition: width var(--transition-base);
}

/* Main Content */
.main {
    flex: 1;
    margin-left: var(--sidebar-width);
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}

/* Header */
.header {
    height: var(--header-height);
    background: var(--bg-card);
    border-bottom: 1px solid var(--border-light);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 1.5rem;
    position: sticky;
    top: 0;
    z-index: 50;
}

.header-left {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.header-title {
    font-family: 'Bitter', Georgia, serif;
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--text-primary);
}

.header-right {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

/* Content */
.content {
    flex: 1;
    padding: 1.5rem;
    max-width: 1400px;
    width: 100%;
    margin: 0 auto;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   COMPOSANTS UI
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* Cards */
.card {
    background: var(--bg-card);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--border-light);
    overflow: hidden;
}

.card-header {
    padding: 1rem 1.25rem;
    border-bottom: 1px solid var(--border-light);
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: var(--gray-50);
}

.card-title {
    font-family: 'Bitter', Georgia, serif;
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.card-body {
    padding: 1.25rem;
}

.card-footer {
    padding: 1rem 1.25rem;
    border-top: 1px solid var(--border-light);
    background: var(--gray-50);
    display: flex;
    justify-content: flex-end;
    gap: 0.75rem;
}

/* Buttons */
.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    font-family: inherit;
    font-size: 0.875rem;
    font-weight: 500;
    border-radius: var(--radius-md);
    border: none;
    cursor: pointer;
    transition: all var(--transition-fast);
    text-decoration: none;
    white-space: nowrap;
}

.btn-primary {
    background: var(--primary-600);
    color: var(--white);
}
.btn-primary:hover {
    background: var(--primary-700);
    box-shadow: var(--shadow-md);
}

.btn-secondary {
    background: var(--gray-200);
    color: var(--text-primary);
}
.btn-secondary:hover {
    background: var(--gray-300);
}

.btn-success {
    background: var(--success-600);
    color: var(--white);
}
.btn-success:hover {
    background: var(--success-500);
}

.btn-warning {
    background: var(--accent-500);
    color: var(--gray-900);
}
.btn-warning:hover {
    background: var(--accent-600);
}

.btn-danger {
    background: var(--danger-600);
    color: var(--white);
}
.btn-danger:hover {
    background: var(--danger-500);
}

.btn-outline {
    background: transparent;
    border: 1px solid var(--border-default);
    color: var(--text-primary);
}
.btn-outline:hover {
    background: var(--gray-100);
    border-color: var(--border-strong);
}

.btn-sm {
    padding: 0.35rem 0.75rem;
    font-size: 0.8rem;
}

.btn-lg {
    padding: 0.75rem 1.5rem;
    font-size: 1rem;
}

.btn-icon {
    width: 36px;
    height: 36px;
    padding: 0;
}

/* Forms */
.form-group {
    margin-bottom: 1rem;
}

.form-label {
    display: block;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--text-primary);
    margin-bottom: 0.375rem;
}

.form-hint {
    font-size: 0.75rem;
    color: var(--text-muted);
    margin-top: 0.25rem;
}

.form-input,
.form-select,
.form-textarea {
    width: 100%;
    padding: 0.625rem 0.875rem;
    font-family: inherit;
    font-size: 0.9rem;
    color: var(--text-primary);
    background: var(--bg-input);
    border: 1px solid var(--border-default);
    border-radius: var(--radius-md);
    transition: all var(--transition-fast);
}

.form-input:focus,
.form-select:focus,
.form-textarea:focus {
    outline: none;
    border-color: var(--primary-500);
    box-shadow: 0 0 0 3px rgba(74, 144, 217, 0.15);
}

.form-textarea {
    min-height: 100px;
    resize: vertical;
    line-height: 1.5;
}

/* Grid layouts */
.grid-2 {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
}

.grid-3 {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
}

.grid-4 {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
}

@media (max-width: 1024px) {
    .grid-4 { grid-template-columns: repeat(2, 1fr); }
    .grid-3 { grid-template-columns: repeat(2, 1fr); }
}

@media (max-width: 768px) {
    .grid-4, .grid-3, .grid-2 { grid-template-columns: 1fr; }
    .sidebar { transform: translateX(-100%); }
    .sidebar.open { transform: translateX(0); }
    .main { margin-left: 0; }
}

/* Badges */
.badge {
    display: inline-flex;
    align-items: center;
    padding: 0.2rem 0.6rem;
    font-size: 0.7rem;
    font-weight: 600;
    border-radius: 100px;
    text-transform: uppercase;
    letter-spacing: 0.03em;
}

.badge-primary { background: var(--primary-100); color: var(--primary-700); }
.badge-success { background: var(--success-100); color: var(--success-600); }
.badge-warning { background: var(--warning-100); color: var(--warning-600); }
.badge-danger { background: var(--danger-100); color: var(--danger-600); }

/* Stats cards */
.stat-card {
    background: var(--bg-card);
    border-radius: var(--radius-lg);
    padding: 1.25rem;
    border: 1px solid var(--border-light);
}

.stat-card-icon {
    width: 40px;
    height: 40px;
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.25rem;
    margin-bottom: 0.75rem;
}

.stat-card-value {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--text-primary);
    line-height: 1;
    margin-bottom: 0.25rem;
}

.stat-card-label {
    font-size: 0.8rem;
    color: var(--text-secondary);
}

/* Tabs */
.tabs {
    display: flex;
    gap: 0.25rem;
    border-bottom: 1px solid var(--border-light);
    margin-bottom: 1.5rem;
}

.tab {
    padding: 0.75rem 1rem;
    font-size: 0.9rem;
    font-weight: 500;
    color: var(--text-secondary);
    background: none;
    border: none;
    cursor: pointer;
    position: relative;
    transition: all var(--transition-fast);
}

.tab:hover {
    color: var(--text-primary);
}

.tab.active {
    color: var(--primary-600);
}

.tab.active::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--primary-600);
}

/* Toast notifications */
.toast-container {
    position: fixed;
    bottom: 1.5rem;
    right: 1.5rem;
    z-index: 1000;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.toast {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.875rem 1.25rem;
    background: var(--gray-800);
    color: var(--white);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-lg);
    animation: slideIn 0.3s ease;
}

.toast.success { border-left: 4px solid var(--success-500); }
.toast.error { border-left: 4px solid var(--danger-500); }
.toast.warning { border-left: 4px solid var(--warning-500); }

@keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

/* Pages */
.page {
    display: none;
}

.page.active {
    display: block;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Phase badges */
.phase-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 0.85rem;
}

.phase-voir { background: #e0f2fe; color: #0369a1; }
.phase-juger { background: #fef3c7; color: #b45309; }
.phase-agir { background: #dcfce7; color: #15803d; }

/* Mermaid diagrams */
.mermaid-container {
    background: var(--gray-50);
    border-radius: var(--radius-md);
    padding: 1.5rem;
    overflow-x: auto;
}

/* Actor cards */
.actor-card {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    background: var(--gray-50);
    border-radius: var(--radius-md);
    border: 1px solid var(--border-light);
}

.actor-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    font-size: 0.9rem;
    flex-shrink: 0;
}

.actor-avatar.ally { background: var(--success-100); color: var(--success-600); }
.actor-avatar.opponent { background: var(--danger-100); color: var(--danger-600); }
.actor-avatar.neutral { background: var(--gray-200); color: var(--gray-600); }

.actor-info {
    flex: 1;
    min-width: 0;
}

.actor-name {
    font-weight: 600;
    font-size: 0.9rem;
    color: var(--text-primary);
}

.actor-role {
    font-size: 0.8rem;
    color: var(--text-secondary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.actor-power {
    display: flex;
    gap: 2px;
}

.power-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--gray-300);
}

.power-dot.filled {
    background: var(--accent-500);
}

/* Export options */
.export-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 1rem;
}

.export-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    padding: 1.25rem;
    background: var(--gray-50);
    border: 2px solid var(--border-light);
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.export-option:hover {
    border-color: var(--primary-500);
    background: var(--primary-100);
}

.export-icon {
    font-size: 2rem;
}

.export-label {
    font-weight: 600;
    font-size: 0.9rem;
}

.export-desc {
    font-size: 0.75rem;
    color: var(--text-muted);
}

/* Print styles */
@media print {
    .sidebar, .header, .btn, .toast-container { display: none !important; }
    .main { margin-left: 0 !important; }
    .page { display: block !important; page-break-after: always; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   UTILITY CLASSES
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.mt-1 { margin-top: 0.5rem; }
.mt-2 { margin-top: 1rem; }
.mt-3 { margin-top: 1.5rem; }
.mt-4 { margin-top: 2rem; }
.mb-1 { margin-bottom: 0.5rem; }
.mb-2 { margin-bottom: 1rem; }
.mb-3 { margin-bottom: 1.5rem; }
.mb-4 { margin-bottom: 2rem; }
.text-center { text-align: center; }
.text-muted { color: var(--text-muted); }
.text-success { color: var(--success-600); }
.text-danger { color: var(--danger-600); }
.font-mono { font-family: 'JetBrains Mono', monospace; }
    </style>
</head>
<body>
    <div class="app">
        <!-- SIDEBAR -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="#" class="sidebar-logo">
                    <div class="sidebar-logo-icon">âš–ï¸</div>
                    <div>
                        <div class="sidebar-logo-text">Plaidoyer Citoyen</div>
                        <div class="sidebar-logo-sub">Poste de Travail v3</div>
                    </div>
                </a>
            </div>
            
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">GÃ©nÃ©ral</div>
                    <button class="nav-item active" data-page="dashboard">
                        <span class="nav-item-icon">ğŸ“Š</span>
                        <span>Tableau de bord</span>
                    </button>
                    <button class="nav-item" data-page="project">
                        <span class="nav-item-icon">ğŸ“</span>
                        <span>Projet</span>
                    </button>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">ğŸ‘ï¸ Phase VOIR</div>
                    <button class="nav-item" data-page="domino">
                        <span class="nav-item-icon">ğŸ¯</span>
                        <span>Domino (Vision)</span>
                    </button>
                    <button class="nav-item" data-page="profil">
                        <span class="nav-item-icon">ğŸ‘¤</span>
                        <span>Profil citoyen</span>
                    </button>
                    <button class="nav-item" data-page="fleur">
                        <span class="nav-item-icon">ğŸŒ¸</span>
                        <span>Fleur du pouvoir</span>
                    </button>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">âš–ï¸ Phase JUGER</div>
                    <button class="nav-item" data-page="acteurs">
                        <span class="nav-item-icon">ğŸ‘¥</span>
                        <span>Cartographie acteurs</span>
                    </button>
                    <button class="nav-item" data-page="arbre">
                        <span class="nav-item-icon">ğŸŒ³</span>
                        <span>Arbre Ã  problÃ¨mes</span>
                    </button>
                    <button class="nav-item" data-page="pourquoi">
                        <span class="nav-item-icon">â“</span>
                        <span>5 Pourquoi</span>
                    </button>
                    <button class="nav-item" data-page="swot">
                        <span class="nav-item-icon">ğŸ“</span>
                        <span>Analyse SWOT</span>
                    </button>
                    <button class="nav-item" data-page="pestel">
                        <span class="nav-item-icon">ğŸŒ</span>
                        <span>Analyse PESTEL</span>
                    </button>
                    <button class="nav-item" data-page="tdc">
                        <span class="nav-item-icon">ğŸ”„</span>
                        <span>ThÃ©orie du changement</span>
                    </button>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">âœŠ Phase AGIR</div>
                    <button class="nav-item" data-page="pouvoir">
                        <span class="nav-item-icon">âš¡</span>
                        <span>Avec/Sans/Contre</span>
                    </button>
                    <button class="nav-item" data-page="cibles">
                        <span class="nav-item-icon">ğŸ¯</span>
                        <span>Cibles & AlliÃ©s</span>
                    </button>
                    <button class="nav-item" data-page="smart">
                        <span class="nav-item-icon">ğŸ“‹</span>
                        <span>Objectifs SMART</span>
                    </button>
                    <button class="nav-item" data-page="message">
                        <span class="nav-item-icon">ğŸ’¬</span>
                        <span>Message clÃ©</span>
                    </button>
                    <button class="nav-item" data-page="evaluation">
                        <span class="nav-item-icon">ğŸ“ˆ</span>
                        <span>Suivi-Ã©valuation</span>
                    </button>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Outils</div>
                    <button class="nav-item" data-page="journal">
                        <span class="nav-item-icon">ğŸ““</span>
                        <span>Journal de bord</span>
                    </button>
                    <button class="nav-item" data-page="export">
                        <span class="nav-item-icon">ğŸ’¾</span>
                        <span>Import / Export</span>
                    </button>
                </div>
            </nav>
            
            <div class="sidebar-progress">
                <div class="progress-label">
                    <span>Progression globale</span>
                    <span id="global-progress">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="global-progress-bar" style="width: 0%"></div>
                </div>
            </div>
        </aside>
        
        <!-- MAIN -->
        <main class="main">
            <header class="header">
                <div class="header-left">
                    <button class="btn btn-icon btn-outline" id="menu-toggle" style="display: none;">â˜°</button>
                    <h1 class="header-title" id="page-title">Tableau de bord</h1>
                </div>
                <div class="header-right">
                    <button class="btn btn-outline btn-sm" onclick="saveProject()">
                        ğŸ’¾ Sauvegarder
                    </button>
                    <button class="btn btn-primary btn-sm" onclick="showPage('export')">
                        ğŸ“¤ Exporter
                    </button>
                </div>
            </header>
            
            <div class="content">
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: DASHBOARD
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page active" id="page-dashboard">
                    <div class="grid-4 mb-3">
                        <div class="stat-card">
                            <div class="stat-card-icon" style="background: var(--primary-100); color: var(--primary-600);">ğŸ“</div>
                            <div class="stat-card-value" id="stat-fields">0</div>
                            <div class="stat-card-label">Champs remplis</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-card-icon" style="background: var(--success-100); color: var(--success-600);">ğŸ‘¥</div>
                            <div class="stat-card-value" id="stat-actors">0</div>
                            <div class="stat-card-label">Acteurs cartographiÃ©s</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-card-icon" style="background: var(--warning-100); color: var(--warning-600);">ğŸ¯</div>
                            <div class="stat-card-value" id="stat-objectives">0</div>
                            <div class="stat-card-label">Objectifs SMART</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-card-icon" style="background: var(--accent-200); color: var(--accent-600);">ğŸ““</div>
                            <div class="stat-card-value" id="stat-journal">0</div>
                            <div class="stat-card-label">EntrÃ©es journal</div>
                        </div>
                    </div>
                    
                    <div class="grid-3 mb-3">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><span class="phase-badge phase-voir">ğŸ‘ï¸ VOIR</span></h3>
                            </div>
                            <div class="card-body">
                                <div class="progress-label">
                                    <span>Analyse de la situation</span>
                                    <span id="progress-voir">0%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="progress-voir-bar" style="width: 0%; background: #0ea5e9;"></div>
                                </div>
                                <p class="text-muted mt-1" style="font-size: 0.8rem;">Domino, Profil, Fleur du pouvoir</p>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><span class="phase-badge phase-juger">âš–ï¸ JUGER</span></h3>
                            </div>
                            <div class="card-body">
                                <div class="progress-label">
                                    <span>Analyse stratÃ©gique</span>
                                    <span id="progress-juger">0%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="progress-juger-bar" style="width: 0%; background: #f59e0b;"></div>
                                </div>
                                <p class="text-muted mt-1" style="font-size: 0.8rem;">Acteurs, Arbre, SWOT, PESTEL, TdC</p>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><span class="phase-badge phase-agir">âœŠ AGIR</span></h3>
                            </div>
                            <div class="card-body">
                                <div class="progress-label">
                                    <span>Passage Ã  l'action</span>
                                    <span id="progress-agir">0%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="progress-agir-bar" style="width: 0%; background: #22c55e;"></div>
                                </div>
                                <p class="text-muted mt-1" style="font-size: 0.8rem;">Pouvoir, Cibles, SMART, Message</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">ğŸ“Œ Informations du projet</h3>
                        </div>
                        <div class="card-body">
                            <div class="grid-2">
                                <div class="form-group">
                                    <label class="form-label">Nom du projet</label>
                                    <input type="text" class="form-input" id="project-name" data-field="project.name" placeholder="Ex: Campagne Stop Arizona">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Organisation</label>
                                    <input type="text" class="form-input" id="project-org" data-field="project.organization" placeholder="Ex: Collectif citoyen...">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Description courte</label>
                                <textarea class="form-textarea" id="project-desc" data-field="project.description" rows="2" placeholder="RÃ©sumez votre projet de plaidoyer en quelques phrases..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: PROJET
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page" id="page-project">
                    <div class="card mb-3">
                        <div class="card-header">
                            <h3 class="card-title">ğŸ“ MÃ©tadonnÃ©es du projet</h3>
                        </div>
                        <div class="card-body">
                            <div class="grid-2">
                                <div class="form-group">
                                    <label class="form-label">Date de crÃ©ation</label>
                                    <input type="date" class="form-input" id="project-created" data-field="project.created">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Ã‰chÃ©ance visÃ©e</label>
                                    <input type="date" class="form-input" id="project-deadline" data-field="project.deadline">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Tags / Mots-clÃ©s</label>
                                <input type="text" class="form-input" id="project-tags" data-field="project.tags" placeholder="Ex: droits sociaux, chÃ´mage, Arizona, CPAS...">
                                <p class="form-hint">SÃ©parez les tags par des virgules</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">ğŸ“š Sources et rÃ©fÃ©rences</h3>
                        </div>
                        <div class="card-body">
                            <p class="text-muted mb-2">Cet outil s'inspire des mÃ©thodologies de :</p>
                            <ul style="margin-left: 1.5rem; color: var(--text-secondary);">
                                <li><strong>Commission Justice et Paix</strong> â€” Le petit guide du plaidoyer citoyen (2020)</li>
                                <li><strong>ULB-CoopÃ©ration</strong> â€” Manuel Plaidoyer v4 (2022)</li>
                                <li><strong>CNCD-11.11.11</strong> â€” Kit (In)Ã©galitÃ©s mondiales</li>
                                <li><strong>Oxfam</strong> â€” Formation "Le plaidoyer de A Ã  Z"</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: DOMINO
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page" id="page-domino">
                    <p class="text-muted mb-3">L'outil Domino vous aide Ã  clarifier votre vision du changement : pourquoi agir, quelles valeurs dÃ©fendre, quels changements obtenir, quel monde construire.</p>
                    
                    <div class="card mb-3">
                        <div class="card-header">
                            <h3 class="card-title">ğŸ¯ Vision et ambition</h3>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">Quelle est votre vision du changement ?</label>
                                <textarea class="form-textarea" data-field="domino.vision" rows="4" placeholder="DÃ©crivez le changement que vous souhaitez voir advenir. Quel est l'horizon de votre plaidoyer ?"></textarea>
                                <p class="form-hint">Exemple : "D'ici 2027, obtenir l'annulation de la limitation des allocations de chÃ´mage Ã  24 mois..."</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid-2 mb-3">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">ğŸš§ Obstacles identifiÃ©s</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="domino.obstacles" rows="6" placeholder="Quels sont les principaux obstacles Ã  surmonter ? (politiques, administratifs, culturels...)"></textarea>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">ğŸ’ª Ressources disponibles</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="domino.ressources" rows="6" placeholder="Quelles ressources pouvez-vous mobiliser ? (rÃ©seaux, expertise, financement, lÃ©gitimitÃ©...)"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-footer">
                            <button class="btn btn-secondary" onclick="showPage('profil')">Suivant : Profil citoyen â†’</button>
                        </div>
                    </div>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: PROFIL CITOYEN
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page" id="page-profil">
                    <p class="text-muted mb-3">DÃ©finissez votre profil en tant que citoyenÂ·ne engagÃ©Â·e : motivations, compÃ©tences, disponibilitÃ©s et limites.</p>
                    
                    <div class="grid-2">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title">â¤ï¸ Motivations</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="profil.motivations" rows="5" placeholder="Pourquoi vous engagez-vous ? Quel vÃ©cu, quelle conviction vous anime ?"></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title">ğŸ› ï¸ CompÃ©tences</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="profil.competences" rows="5" placeholder="Quelles compÃ©tences apportez-vous ? (analyse, communication, juridique, mobilisation...)"></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title">â° Temps disponible</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="profil.temps" rows="5" placeholder="Combien de temps pouvez-vous consacrer ? Quelles sont vos disponibilitÃ©s ?"></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title">âš ï¸ Limites</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="profil.limites" rows="5" placeholder="Quelles sont vos contraintes et limites ? (financiÃ¨res, risques, lignes rouges...)"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: FLEUR DU POUVOIR
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page" id="page-fleur">
                    <p class="text-muted mb-3">La Fleur du pouvoir analyse les rapports de domination et de privilÃ¨ge. Qui sont les personnes concernÃ©es ? Quels privilÃ¨ges relatifs avez-vous ? Quelles discriminations subissez-vous ?</p>
                    
                    <div class="card mb-3">
                        <div class="card-header">
                            <h3 class="card-title">ğŸ‘¥ IdentitÃ©s des personnes concernÃ©es</h3>
                        </div>
                        <div class="card-body">
                            <textarea class="form-textarea" data-field="fleur.identites" rows="5" placeholder="DÃ©crivez les profils des personnes directement concernÃ©es par votre plaidoyer (Ã¢ge, genre, situation socio-Ã©conomique, gÃ©ographie...)"></textarea>
                        </div>
                    </div>
                    
                    <div class="grid-2">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title" style="color: var(--success-600);">âœ… PrivilÃ¨ges relatifs</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="fleur.privileges" rows="5" placeholder="Quels avantages relatifs avez-vous ? (accÃ¨s Ã  l'information, capital social, lÃ©gitimitÃ© de parole...)"></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title" style="color: var(--danger-600);">ğŸ¯ Oppressions subies</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="fleur.oppressions" rows="5" placeholder="Quelles discriminations ou violences (symboliques, administratives, Ã©conomiques) subissent les personnes concernÃ©es ?"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: ACTEURS
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page" id="page-acteurs">
                    <p class="text-muted mb-3">Cartographiez les acteurs clÃ©s de votre plaidoyer : dÃ©cideurs, alliÃ©s, opposants, neutres. Ã‰valuez leur pouvoir d'influence.</p>
                    
                    <div class="card mb-3">
                        <div class="card-header">
                            <h3 class="card-title">â• Ajouter un acteur</h3>
                        </div>
                        <div class="card-body">
                            <div class="grid-4">
                                <div class="form-group">
                                    <label class="form-label">Nom</label>
                                    <input type="text" class="form-input" id="actor-name" placeholder="Nom de l'acteur">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">RÃ´le / Fonction</label>
                                    <input type="text" class="form-input" id="actor-role" placeholder="Ex: Ministre, DÃ©putÃ©...">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Position</label>
                                    <select class="form-select" id="actor-position">
                                        <option value="ally">ğŸŸ¢ AlliÃ©</option>
                                        <option value="neutral">ğŸŸ¡ Neutre</option>
                                        <option value="opponent">ğŸ”´ Opposant</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Pouvoir (1-5)</label>
                                    <select class="form-select" id="actor-power">
                                        <option value="1">1 - Faible</option>
                                        <option value="2">2</option>
                                        <option value="3" selected>3 - Moyen</option>
                                        <option value="4">4</option>
                                        <option value="5">5 - Fort</option>
                                    </select>
                                </div>
                            </div>
                            <button class="btn btn-primary mt-2" onclick="addActor()">â• Ajouter l'acteur</button>
                        </div>
                    </div>
                    
                    <div class="grid-3 mb-3">
                        <div class="card">
                            <div class="card-header" style="background: var(--success-100);">
                                <h3 class="card-title" style="color: var(--success-600);">ğŸŸ¢ AlliÃ©s</h3>
                            </div>
                            <div class="card-body" id="actors-ally" style="min-height: 150px;">
                                <p class="text-muted text-center">Aucun alliÃ©</p>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header" style="background: var(--gray-200);">
                                <h3 class="card-title">ğŸŸ¡ Neutres</h3>
                            </div>
                            <div class="card-body" id="actors-neutral" style="min-height: 150px;">
                                <p class="text-muted text-center">Aucun neutre</p>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header" style="background: var(--danger-100);">
                                <h3 class="card-title" style="color: var(--danger-600);">ğŸ”´ Opposants</h3>
                            </div>
                            <div class="card-body" id="actors-opponent" style="min-height: 150px;">
                                <p class="text-muted text-center">Aucun opposant</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">ğŸ“Š Visualisation (Mermaid)</h3>
                        </div>
                        <div class="card-body">
                            <div class="mermaid-container" id="actors-diagram">
                                <pre class="mermaid" id="actors-mermaid">
graph LR
    subgraph AlliÃ©s
    A1[Ajoutez des acteurs]
    end
                                </pre>
                            </div>
                            <button class="btn btn-secondary btn-sm mt-2" onclick="updateActorsDiagram()">ğŸ”„ RafraÃ®chir le diagramme</button>
                        </div>
                    </div>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: ARBRE Ã€ PROBLÃˆMES
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page" id="page-arbre">
                    <p class="text-muted mb-3">L'arbre Ã  problÃ¨mes identifie le problÃ¨me central, ses causes profondes (racines) et ses effets/consÃ©quences (branches).</p>
                    
                    <div class="card mb-3">
                        <div class="card-header">
                            <h3 class="card-title">ğŸ¯ ProblÃ¨me central</h3>
                        </div>
                        <div class="card-body">
                            <textarea class="form-textarea" data-field="arbre.probleme" rows="3" placeholder="Quel est le problÃ¨me central que vous cherchez Ã  rÃ©soudre ?"></textarea>
                        </div>
                    </div>
                    
                    <div class="grid-2 mb-3">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">ğŸŒ± Causes (racines)</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="arbre.causes" rows="6" placeholder="Listez les causes profondes du problÃ¨me (une par ligne)"></textarea>
                                <p class="form-hint">Entrez une cause par ligne</p>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">ğŸƒ Effets (branches)</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="arbre.effets" rows="6" placeholder="Listez les consÃ©quences du problÃ¨me (une par ligne)"></textarea>
                                <p class="form-hint">Entrez un effet par ligne</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">ğŸŒ³ Visualisation de l'arbre</h3>
                        </div>
                        <div class="card-body">
                            <div class="mermaid-container">
                                <pre class="mermaid" id="tree-mermaid">
graph TB
    subgraph Effets
    E1[Effet 1]
    E2[Effet 2]
    end
    P[ProblÃ¨me central]
    subgraph Causes
    C1[Cause 1]
    C2[Cause 2]
    end
    C1 --> P
    C2 --> P
    P --> E1
    P --> E2
                                </pre>
                            </div>
                            <button class="btn btn-secondary btn-sm mt-2" onclick="updateTreeDiagram()">ğŸ”„ RafraÃ®chir l'arbre</button>
                        </div>
                    </div>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: 5 POURQUOI
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page" id="page-pourquoi">
                    <p class="text-muted mb-3">La mÃ©thode des 5 Pourquoi permet de remonter Ã  la cause racine d'un problÃ¨me en posant successivement la question "Pourquoi ?".</p>
                    
                    <div class="card mb-3">
                        <div class="card-header">
                            <h3 class="card-title">â“ ProblÃ¨me de dÃ©part</h3>
                        </div>
                        <div class="card-body">
                            <textarea class="form-textarea" data-field="pourquoi.probleme" rows="2" placeholder="DÃ©crivez le problÃ¨me ou symptÃ´me observÃ©"></textarea>
                        </div>
                    </div>
                    
                    <div class="card mb-3">
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">1ï¸âƒ£ Pourquoi ce problÃ¨me existe-t-il ?</label>
                                <textarea class="form-textarea" data-field="pourquoi.why1" rows="2" placeholder="PremiÃ¨re rÃ©ponse..."></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">2ï¸âƒ£ Pourquoi cette cause ?</label>
                                <textarea class="form-textarea" data-field="pourquoi.why2" rows="2" placeholder="DeuxiÃ¨me rÃ©ponse..."></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">3ï¸âƒ£ Pourquoi cette cause ?</label>
                                <textarea class="form-textarea" data-field="pourquoi.why3" rows="2" placeholder="TroisiÃ¨me rÃ©ponse..."></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">4ï¸âƒ£ Pourquoi cette cause ?</label>
                                <textarea class="form-textarea" data-field="pourquoi.why4" rows="2" placeholder="QuatriÃ¨me rÃ©ponse..."></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">5ï¸âƒ£ Pourquoi cette cause ? â†’ <strong>Cause racine</strong></label>
                                <textarea class="form-textarea" data-field="pourquoi.why5" rows="2" placeholder="Cause racine identifiÃ©e..." style="border-color: var(--accent-500);"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: SWOT
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page" id="page-swot">
                    <p class="text-muted mb-3">L'analyse SWOT Ã©value les Forces et Faiblesses internes de votre mouvement, ainsi que les OpportunitÃ©s et Menaces externes.</p>
                    
                    <div class="grid-2">
                        <div class="card mb-3">
                            <div class="card-header" style="background: var(--success-100);">
                                <h3 class="card-title" style="color: var(--success-600);">ğŸ’ª Forces (Strengths)</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="swot.forces" rows="5" placeholder="Atouts internes : expertise, rÃ©seau, lÃ©gitimitÃ©, ressources..."></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header" style="background: var(--danger-100);">
                                <h3 class="card-title" style="color: var(--danger-600);">ğŸ˜° Faiblesses (Weaknesses)</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="swot.faiblesses" rows="5" placeholder="Limites internes : manque de moyens, divisions, visibilitÃ© faible..."></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header" style="background: var(--primary-100);">
                                <h3 class="card-title" style="color: var(--primary-700);">ğŸŒŸ OpportunitÃ©s (Opportunities)</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="swot.opportunites" rows="5" placeholder="Facteurs externes favorables : Ã©lections, mÃ©diatisation, alliances possibles..."></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header" style="background: var(--warning-100);">
                                <h3 class="card-title" style="color: var(--warning-600);">âš ï¸ Menaces (Threats)</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="swot.menaces" rows="5" placeholder="Facteurs externes dÃ©favorables : opposition forte, contexte hostile, fatigue militante..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: PESTEL
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page" id="page-pestel">
                    <p class="text-muted mb-3">L'analyse PESTEL examine le macro-environnement : facteurs Politiques, Ã‰conomiques, Sociaux, Technologiques, Environnementaux et LÃ©gaux.</p>
                    
                    <div class="grid-2">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title">ğŸ›ï¸ Politique</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="pestel.politique" rows="4" placeholder="Contexte politique, gouvernance, stabilitÃ©, Ã©lections..."></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title">ğŸ’¶ Ã‰conomique</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="pestel.economique" rows="4" placeholder="Conjoncture, budgets, emploi, inflation, financements..."></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title">ğŸ‘¥ Social</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="pestel.social" rows="4" placeholder="Tendances sociales, dÃ©mographie, inÃ©galitÃ©s, opinions..."></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title">ğŸ’» Technologique</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="pestel.technologique" rows="4" placeholder="Innovations, digitalisation, fracture numÃ©rique, outils..."></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title">ğŸŒ± Environnemental</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="pestel.environnemental" rows="4" placeholder="Enjeux Ã©cologiques, climat, ressources, transition..."></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title">âš–ï¸ LÃ©gal</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="pestel.legal" rows="4" placeholder="Cadre juridique, droits, recours possibles, jurisprudence..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: THÃ‰ORIE DU CHANGEMENT
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page" id="page-tdc">
                    <p class="text-muted mb-3">La ThÃ©orie du Changement (ToC) articule vos hypothÃ¨ses sur comment le changement se produit : quels rÃ©sultats intermÃ©diaires mÃ¨neront Ã  l'impact final ?</p>
                    
                    <div class="card mb-3">
                        <div class="card-header">
                            <h3 class="card-title">ğŸ¯ Vision du changement (Impact final)</h3>
                        </div>
                        <div class="card-body">
                            <textarea class="form-textarea" data-field="tdc.impact" rows="2" placeholder="Quel changement ultime voulez-vous voir dans la sociÃ©tÃ© ?"></textarea>
                        </div>
                    </div>
                    
                    <div class="grid-2 mb-3">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">ğŸ”¹ Changement individuel interne</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="tdc.individuel_interne" rows="3" placeholder="Changement de connaissances, attitudes, compÃ©tences des individus..."></textarea>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">ğŸ”¹ Changement individuel externe</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="tdc.individuel_externe" rows="3" placeholder="Changement de comportements observables des individus..."></textarea>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">ğŸ”¸ Changement collectif interne</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="tdc.collectif_interne" rows="3" placeholder="Changement de culture, normes, valeurs d'un groupe..."></textarea>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">ğŸ”¸ Changement collectif externe</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="tdc.collectif_externe" rows="3" placeholder="Changement de politiques, lois, institutions, systÃ¨mes..."></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">ğŸ”— HypothÃ¨ses sous-jacentes</h3>
                        </div>
                        <div class="card-body">
                            <textarea class="form-textarea" data-field="tdc.hypotheses" rows="4" placeholder="Quelles hypothÃ¨ses faites-vous sur comment ces changements s'enchaÃ®nent ? (Si X alors Y...)"></textarea>
                        </div>
                    </div>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: AVEC/SANS/CONTRE LE POUVOIR
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page" id="page-pouvoir">
                    <p class="text-muted mb-3">DÃ©finissez votre positionnement stratÃ©gique par rapport aux institutions et au pouvoir Ã©tabli.</p>
                    
                    <div class="grid-3">
                        <div class="card mb-3">
                            <div class="card-header" style="background: var(--success-100); border-bottom: 3px solid var(--success-500);">
                                <h3 class="card-title" style="color: var(--success-600);">ğŸ¤ AVEC le pouvoir</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="pouvoir.avec" rows="6" placeholder="Collaboration, dialogue, participation aux instances officielles, lobbying constructif..."></textarea>
                                <p class="form-hint mt-1">Ex: Auditions parlementaires, commissions consultatives</p>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header" style="background: var(--warning-100); border-bottom: 3px solid var(--warning-500);">
                                <h3 class="card-title" style="color: var(--warning-600);">ğŸ”„ SANS le pouvoir</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="pouvoir.sans" rows="6" placeholder="Actions autonomes, alternatives, construction d'espaces propres..."></textarea>
                                <p class="form-hint mt-1">Ex: Projets pilotes, mÃ©dias alternatifs, Ã©conomie sociale</p>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header" style="background: var(--danger-100); border-bottom: 3px solid var(--danger-500);">
                                <h3 class="card-title" style="color: var(--danger-600);">âœŠ CONTRE le pouvoir</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="pouvoir.contre" rows="6" placeholder="Opposition, contestation, mobilisation de masse, rapport de force..."></textarea>
                                <p class="form-hint mt-1">Ex: Manifestations, pÃ©titions, dÃ©sobÃ©issance civile</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: CIBLES & ALLIÃ‰S
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page" id="page-cibles">
                    <p class="text-muted mb-3">Identifiez prÃ©cisÃ©ment vos cibles de plaidoyer (qui a le pouvoir de dÃ©cision) et vos alliÃ©s stratÃ©giques.</p>
                    
                    <div class="grid-2">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title">ğŸ¯ Cible principale</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="cibles.principale" rows="3" placeholder="Qui a le pouvoir de dÃ©cision direct sur votre problÃ©matique ?"></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title">ğŸ¯ Cibles secondaires</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="cibles.secondaires" rows="3" placeholder="Qui peut influencer la cible principale ?"></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title" style="color: var(--success-600);">ğŸ¤ AlliÃ©s potentiels</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="cibles.allies" rows="3" placeholder="Organisations, rÃ©seaux, personnalitÃ©s qui partagent vos objectifs..."></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title" style="color: var(--danger-600);">âš”ï¸ Opposants identifiÃ©s</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="cibles.opposants" rows="3" placeholder="Qui s'oppose activement Ã  vos objectifs ? Pourquoi ?"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: OBJECTIFS SMART
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page" id="page-smart">
                    <p class="text-muted mb-3">DÃ©finissez des objectifs SMART : SpÃ©cifiques, Mesurables, Atteignables, RÃ©alistes, Temporellement dÃ©finis.</p>
                    
                    <div class="card mb-3">
                        <div class="card-header">
                            <h3 class="card-title">â• Ajouter un objectif SMART</h3>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">Objectif</label>
                                <textarea class="form-textarea" id="smart-objective" rows="2" placeholder="Ex: Obtenir 50 000 signatures sur la pÃ©tition d'ici le 1er mars 2026"></textarea>
                            </div>
                            <div class="grid-2">
                                <div class="form-group">
                                    <label class="form-label">Indicateur de mesure</label>
                                    <input type="text" class="form-input" id="smart-indicator" placeholder="Ex: Nombre de signatures">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Ã‰chÃ©ance</label>
                                    <input type="date" class="form-input" id="smart-deadline">
                                </div>
                            </div>
                            <button class="btn btn-primary" onclick="addSmartObjective()">â• Ajouter l'objectif</button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">ğŸ“‹ Objectifs dÃ©finis</h3>
                        </div>
                        <div class="card-body" id="smart-list">
                            <p class="text-muted text-center">Aucun objectif SMART dÃ©fini</p>
                        </div>
                    </div>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: MESSAGE CLÃ‰
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page" id="page-message">
                    <p class="text-muted mb-3">Construisez votre message de plaidoyer : accroche, problÃ¨me, importance, demande d'action.</p>
                    
                    <div class="card mb-3">
                        <div class="card-header">
                            <h3 class="card-title">ğŸ’¬ Construction du message</h3>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">ğŸ£ Accroche (Hook)</label>
                                <textarea class="form-textarea" data-field="message.accroche" rows="2" placeholder="Une phrase percutante pour capter l'attention"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">â— ProblÃ¨me</label>
                                <textarea class="form-textarea" data-field="message.probleme" rows="2" placeholder="DÃ©crivez le problÃ¨me de maniÃ¨re claire et factuelle"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">âš¡ Pourquoi c'est important ?</label>
                                <textarea class="form-textarea" data-field="message.importance" rows="2" placeholder="Pourquoi faut-il agir maintenant ? Quels sont les enjeux ?"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ğŸ‘‰ Appel Ã  l'action</label>
                                <textarea class="form-textarea" data-field="message.action" rows="2" placeholder="Que demandez-vous concrÃ¨tement ? Ã€ qui ?"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">ğŸ“ AperÃ§u du message compilÃ©</h3>
                        </div>
                        <div class="card-body">
                            <div id="message-preview" style="background: var(--gray-50); padding: 1rem; border-radius: var(--radius-md); font-style: italic; color: var(--text-secondary);">
                                Remplissez les champs ci-dessus pour voir l'aperÃ§u...
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: SUIVI-Ã‰VALUATION
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page" id="page-evaluation">
                    <p class="text-muted mb-3">DÃ©finissez comment vous allez suivre et Ã©valuer l'impact de votre plaidoyer.</p>
                    
                    <div class="grid-2">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title">ğŸ“Š Indicateurs de suivi</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="evaluation.indicateurs" rows="5" placeholder="Quels indicateurs allez-vous suivre ? (quantitatifs et qualitatifs)"></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title">ğŸ” MÃ©thodes de collecte</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="evaluation.methodes" rows="5" placeholder="Comment allez-vous collecter les donnÃ©es ? (sondages, entretiens, revue de presse...)"></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title">ğŸ“… Calendrier d'Ã©valuation</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="evaluation.calendrier" rows="5" placeholder="Ã€ quelle frÃ©quence ? Quels jalons ?"></textarea>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header">
                                <h3 class="card-title">ğŸ“š LeÃ§ons apprises</h3>
                            </div>
                            <div class="card-body">
                                <textarea class="form-textarea" data-field="evaluation.lecons" rows="5" placeholder="Notez ici les apprentissages au fil du projet..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: JOURNAL DE BORD
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page" id="page-journal">
                    <p class="text-muted mb-3">Tenez un journal de bord de vos actions, rencontres, avancÃ©es et difficultÃ©s.</p>
                    
                    <div class="card mb-3">
                        <div class="card-header">
                            <h3 class="card-title">â• Nouvelle entrÃ©e</h3>
                        </div>
                        <div class="card-body">
                            <div class="grid-2">
                                <div class="form-group">
                                    <label class="form-label">Date</label>
                                    <input type="date" class="form-input" id="journal-date">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Type</label>
                                    <select class="form-select" id="journal-type">
                                        <option value="action">ğŸ¯ Action</option>
                                        <option value="rencontre">ğŸ¤ Rencontre</option>
                                        <option value="victoire">ğŸ† Victoire</option>
                                        <option value="difficulte">âš ï¸ DifficultÃ©</option>
                                        <option value="note">ğŸ“ Note</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Description</label>
                                <textarea class="form-textarea" id="journal-content" rows="3" placeholder="DÃ©crivez l'Ã©vÃ©nement, la rencontre, l'action..."></textarea>
                            </div>
                            <button class="btn btn-primary" onclick="addJournalEntry()">â• Ajouter l'entrÃ©e</button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">ğŸ““ Historique</h3>
                        </div>
                        <div class="card-body" id="journal-list">
                            <p class="text-muted text-center">Aucune entrÃ©e dans le journal</p>
                        </div>
                    </div>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     PAGE: IMPORT / EXPORT
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <div class="page" id="page-export">
                    <div class="card mb-3">
                        <div class="card-header">
                            <h3 class="card-title">ğŸ“¤ Exporter le projet</h3>
                        </div>
                        <div class="card-body">
                            <p class="mb-3">Exportez votre projet dans le format de votre choix :</p>
                            <div class="export-grid">
                                <div class="export-option" onclick="exportProject('json')">
                                    <span class="export-icon">ğŸ“„</span>
                                    <span class="export-label">JSON</span>
                                    <span class="export-desc">Sauvegarde complÃ¨te</span>
                                </div>
                                <div class="export-option" onclick="exportProject('md')">
                                    <span class="export-icon">ğŸ“</span>
                                    <span class="export-label">Markdown</span>
                                    <span class="export-desc">Document texte</span>
                                </div>
                                <div class="export-option" onclick="exportProject('html')">
                                    <span class="export-icon">ğŸŒ</span>
                                    <span class="export-label">HTML</span>
                                    <span class="export-desc">Page web</span>
                                </div>
                                <div class="export-option" onclick="exportProject('pdf')">
                                    <span class="export-icon">ğŸ“•</span>
                                    <span class="export-label">PDF</span>
                                    <span class="export-desc">Document imprimable</span>
                                </div>
                                <div class="export-option" onclick="exportProject('docx')">
                                    <span class="export-icon">ğŸ“˜</span>
                                    <span class="export-label">Word</span>
                                    <span class="export-desc">Document Ã©ditable</span>
                                </div>
                                <div class="export-option" onclick="exportProject('xlsx')">
                                    <span class="export-icon">ğŸ“Š</span>
                                    <span class="export-label">Excel</span>
                                    <span class="export-desc">Tableur</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">ğŸ“¥ Importer un projet</h3>
                        </div>
                        <div class="card-body">
                            <p class="mb-2">Chargez un projet prÃ©cÃ©demment exportÃ© (JSON) :</p>
                            <input type="file" id="import-file" accept=".json" class="form-input" onchange="importProject(event)">
                            <p class="form-hint mt-1">âš ï¸ L'import remplacera les donnÃ©es actuelles</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Toast container -->
    <div class="toast-container" id="toast-container"></div>
    
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         JAVASCRIPT
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE MANAGEMENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const APP_VERSION = '3.0.0';
const STORAGE_KEY = 'plaidoyer_citoyen_v3';

let state = {
    version: APP_VERSION,
    project: {
        name: '',
        organization: '',
        description: '',
        created: new Date().toISOString().split('T')[0],
        deadline: '',
        tags: ''
    },
    domino: { vision: '', obstacles: '', ressources: '' },
    profil: { motivations: '', competences: '', temps: '', limites: '' },
    fleur: { identites: '', privileges: '', oppressions: '' },
    acteurs: [],
    arbre: { probleme: '', causes: '', effets: '' },
    pourquoi: { probleme: '', why1: '', why2: '', why3: '', why4: '', why5: '' },
    swot: { forces: '', faiblesses: '', opportunites: '', menaces: '' },
    pestel: { politique: '', economique: '', social: '', technologique: '', environnemental: '', legal: '' },
    tdc: { impact: '', individuel_interne: '', individuel_externe: '', collectif_interne: '', collectif_externe: '', hypotheses: '' },
    pouvoir: { avec: '', sans: '', contre: '' },
    cibles: { principale: '', secondaires: '', allies: '', opposants: '' },
    smart: [],
    message: { accroche: '', probleme: '', importance: '', action: '' },
    evaluation: { indicateurs: '', methodes: '', calendrier: '', lecons: '' },
    journal: []
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INITIALIZATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.addEventListener('DOMContentLoaded', () => {
    loadState();
    initNavigation();
    initAutoSave();
    initMermaid();
    updateStats();
    
    // Set today's date for journal
    document.getElementById('journal-date').value = new Date().toISOString().split('T')[0];
});

function initMermaid() {
    mermaid.initialize({
        startOnLoad: true,
        theme: 'neutral',
        securityLevel: 'loose',
        flowchart: { useMaxWidth: true, htmlLabels: true }
    });
}

function initNavigation() {
    document.querySelectorAll('.nav-item').forEach(item => {
        item.addEventListener('click', () => {
            const page = item.dataset.page;
            showPage(page);
        });
    });
}

function initAutoSave() {
    // Auto-save on field change
    document.querySelectorAll('[data-field]').forEach(field => {
        field.addEventListener('input', debounce(() => {
            const path = field.dataset.field.split('.');
            let obj = state;
            for (let i = 0; i < path.length - 1; i++) {
                obj = obj[path[i]];
            }
            obj[path[path.length - 1]] = field.value;
            saveState(false);
            updateStats();
            updateMessagePreview();
        }, 500));
    });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showPage(pageId) {
    // Update nav
    document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.toggle('active', item.dataset.page === pageId);
    });
    
    // Update pages
    document.querySelectorAll('.page').forEach(page => {
        page.classList.toggle('active', page.id === `page-${pageId}`);
    });
    
    // Update title
    const activeNav = document.querySelector(`.nav-item[data-page="${pageId}"]`);
    if (activeNav) {
        document.getElementById('page-title').textContent = activeNav.textContent.trim();
    }
    
    // Re-render mermaid if needed
    if (pageId === 'acteurs') updateActorsDiagram();
    if (pageId === 'arbre') updateTreeDiagram();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE PERSISTENCE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function saveState(notify = true) {
    try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
        if (notify) showToast('Projet sauvegardÃ©', 'success');
    } catch (e) {
        showToast('Erreur de sauvegarde', 'error');
    }
}

function loadState() {
    try {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) {
            state = { ...state, ...JSON.parse(saved) };
            populateFields();
            renderActors();
            renderSmartObjectives();
            renderJournal();
        }
    } catch (e) {
        console.error('Error loading state:', e);
    }
}

function populateFields() {
    document.querySelectorAll('[data-field]').forEach(field => {
        const path = field.dataset.field.split('.');
        let value = state;
        for (const key of path) {
            value = value?.[key];
        }
        if (value !== undefined) {
            field.value = value;
        }
    });
}

function saveProject() {
    saveState(true);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ACTORS MANAGEMENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function addActor() {
    const name = document.getElementById('actor-name').value.trim();
    const role = document.getElementById('actor-role').value.trim();
    const position = document.getElementById('actor-position').value;
    const power = parseInt(document.getElementById('actor-power').value);
    
    if (!name) {
        showToast('Veuillez entrer un nom', 'error');
        return;
    }
    
    state.acteurs.push({ id: Date.now(), name, role, position, power });
    renderActors();
    saveState(false);
    updateStats();
    
    // Reset form
    document.getElementById('actor-name').value = '';
    document.getElementById('actor-role').value = '';
    
    showToast('Acteur ajoutÃ©', 'success');
}

function removeActor(id) {
    state.acteurs = state.acteurs.filter(a => a.id !== id);
    renderActors();
    saveState(false);
    updateStats();
}

function renderActors() {
    const positions = ['ally', 'neutral', 'opponent'];
    
    positions.forEach(pos => {
        const container = document.getElementById(`actors-${pos}`);
        const actors = state.acteurs.filter(a => a.position === pos);
        
        if (actors.length === 0) {
            container.innerHTML = `<p class="text-muted text-center">Aucun ${pos === 'ally' ? 'alliÃ©' : pos === 'neutral' ? 'neutre' : 'opposant'}</p>`;
        } else {
            container.innerHTML = actors.map(a => `
                <div class="actor-card mb-2">
                    <div class="actor-avatar ${a.position}">${a.name.charAt(0).toUpperCase()}</div>
                    <div class="actor-info">
                        <div class="actor-name">${escapeHtml(a.name)}</div>
                        <div class="actor-role">${escapeHtml(a.role)}</div>
                    </div>
                    <div class="actor-power">
                        ${[1,2,3,4,5].map(i => `<span class="power-dot ${i <= a.power ? 'filled' : ''}"></span>`).join('')}
                    </div>
                    <button class="btn btn-sm btn-outline" onclick="removeActor(${a.id})" title="Supprimer">âœ•</button>
                </div>
            `).join('');
        }
    });
}

function updateActorsDiagram() {
    const allies = state.acteurs.filter(a => a.position === 'ally');
    const neutrals = state.acteurs.filter(a => a.position === 'neutral');
    const opponents = state.acteurs.filter(a => a.position === 'opponent');
    
    let diagram = 'graph LR\n';
    
    if (allies.length) {
        diagram += '    subgraph "ğŸŸ¢ AlliÃ©s"\n';
        allies.forEach((a, i) => diagram += `    A${i}["${a.name}"]\n`);
        diagram += '    end\n';
    }
    
    if (neutrals.length) {
        diagram += '    subgraph "ğŸŸ¡ Neutres"\n';
        neutrals.forEach((a, i) => diagram += `    N${i}["${a.name}"]\n`);
        diagram += '    end\n';
    }
    
    if (opponents.length) {
        diagram += '    subgraph "ğŸ”´ Opposants"\n';
        opponents.forEach((a, i) => diagram += `    O${i}["${a.name}"]\n`);
        diagram += '    end\n';
    }
    
    if (!allies.length && !neutrals.length && !opponents.length) {
        diagram += '    X[Ajoutez des acteurs]\n';
    }
    
    const container = document.getElementById('actors-diagram');
    container.innerHTML = `<pre class="mermaid">${diagram}</pre>`;
    mermaid.run({ nodes: container.querySelectorAll('.mermaid') });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TREE DIAGRAM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateTreeDiagram() {
    const problem = state.arbre.probleme || 'ProblÃ¨me central';
    const causes = state.arbre.causes.split('\n').filter(c => c.trim());
    const effects = state.arbre.effets.split('\n').filter(e => e.trim());
    
    let diagram = 'graph TB\n';
    
    // Effects (top)
    if (effects.length) {
        diagram += '    subgraph "ğŸƒ Effets"\n';
        effects.forEach((e, i) => diagram += `    E${i}["${e.trim().substring(0, 40)}"]\n`);
        diagram += '    end\n';
    }
    
    // Problem (center)
    diagram += `    P["ğŸ¯ ${problem.substring(0, 50)}"]\n`;
    
    // Causes (bottom)
    if (causes.length) {
        diagram += '    subgraph "ğŸŒ± Causes"\n';
        causes.forEach((c, i) => diagram += `    C${i}["${c.trim().substring(0, 40)}"]\n`);
        diagram += '    end\n';
    }
    
    // Links
    causes.forEach((_, i) => diagram += `    C${i} --> P\n`);
    effects.forEach((_, i) => diagram += `    P --> E${i}\n`);
    
    const container = document.querySelector('#page-arbre .mermaid-container');
    container.innerHTML = `<pre class="mermaid">${diagram}</pre>`;
    mermaid.run({ nodes: container.querySelectorAll('.mermaid') });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SMART OBJECTIVES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function addSmartObjective() {
    const objective = document.getElementById('smart-objective').value.trim();
    const indicator = document.getElementById('smart-indicator').value.trim();
    const deadline = document.getElementById('smart-deadline').value;
    
    if (!objective) {
        showToast('Veuillez dÃ©crire l\'objectif', 'error');
        return;
    }
    
    state.smart.push({ id: Date.now(), objective, indicator, deadline, completed: false });
    renderSmartObjectives();
    saveState(false);
    updateStats();
    
    // Reset
    document.getElementById('smart-objective').value = '';
    document.getElementById('smart-indicator').value = '';
    document.getElementById('smart-deadline').value = '';
    
    showToast('Objectif ajoutÃ©', 'success');
}

function toggleSmartObjective(id) {
    const obj = state.smart.find(o => o.id === id);
    if (obj) obj.completed = !obj.completed;
    renderSmartObjectives();
    saveState(false);
}

function removeSmartObjective(id) {
    state.smart = state.smart.filter(o => o.id !== id);
    renderSmartObjectives();
    saveState(false);
    updateStats();
}

function renderSmartObjectives() {
    const container = document.getElementById('smart-list');
    
    if (state.smart.length === 0) {
        container.innerHTML = '<p class="text-muted text-center">Aucun objectif SMART dÃ©fini</p>';
        return;
    }
    
    container.innerHTML = state.smart.map(o => `
        <div class="actor-card mb-2" style="${o.completed ? 'opacity: 0.6;' : ''}">
            <input type="checkbox" ${o.completed ? 'checked' : ''} onchange="toggleSmartObjective(${o.id})" style="width: 20px; height: 20px;">
            <div class="actor-info">
                <div class="actor-name" style="${o.completed ? 'text-decoration: line-through;' : ''}">${escapeHtml(o.objective)}</div>
                <div class="actor-role">ğŸ“Š ${escapeHtml(o.indicator)} | ğŸ“… ${o.deadline || 'Non dÃ©fini'}</div>
            </div>
            <button class="btn btn-sm btn-outline" onclick="removeSmartObjective(${o.id})">âœ•</button>
        </div>
    `).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// JOURNAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function addJournalEntry() {
    const date = document.getElementById('journal-date').value;
    const type = document.getElementById('journal-type').value;
    const content = document.getElementById('journal-content').value.trim();
    
    if (!content) {
        showToast('Veuillez dÃ©crire l\'entrÃ©e', 'error');
        return;
    }
    
    state.journal.unshift({ id: Date.now(), date, type, content });
    renderJournal();
    saveState(false);
    updateStats();
    
    document.getElementById('journal-content').value = '';
    showToast('EntrÃ©e ajoutÃ©e', 'success');
}

function removeJournalEntry(id) {
    state.journal = state.journal.filter(e => e.id !== id);
    renderJournal();
    saveState(false);
    updateStats();
}

function renderJournal() {
    const container = document.getElementById('journal-list');
    
    if (state.journal.length === 0) {
        container.innerHTML = '<p class="text-muted text-center">Aucune entrÃ©e dans le journal</p>';
        return;
    }
    
    const typeIcons = { action: 'ğŸ¯', rencontre: 'ğŸ¤', victoire: 'ğŸ†', difficulte: 'âš ï¸', note: 'ğŸ“' };
    
    container.innerHTML = state.journal.map(e => `
        <div class="actor-card mb-2">
            <div class="actor-avatar neutral">${typeIcons[e.type] || 'ğŸ“'}</div>
            <div class="actor-info">
                <div class="actor-name">${escapeHtml(e.content.substring(0, 100))}${e.content.length > 100 ? '...' : ''}</div>
                <div class="actor-role">ğŸ“… ${e.date}</div>
            </div>
            <button class="btn btn-sm btn-outline" onclick="removeJournalEntry(${e.id})">âœ•</button>
        </div>
    `).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MESSAGE PREVIEW
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateMessagePreview() {
    const m = state.message;
    const preview = document.getElementById('message-preview');
    
    if (!m.accroche && !m.probleme && !m.importance && !m.action) {
        preview.innerHTML = '<span style="color: var(--text-muted);">Remplissez les champs ci-dessus pour voir l\'aperÃ§u...</span>';
        return;
    }
    
    let html = '';
    if (m.accroche) html += `<strong>${escapeHtml(m.accroche)}</strong><br><br>`;
    if (m.probleme) html += `${escapeHtml(m.probleme)}<br><br>`;
    if (m.importance) html += `<em>${escapeHtml(m.importance)}</em><br><br>`;
    if (m.action) html += `<strong>â†’ ${escapeHtml(m.action)}</strong>`;
    
    preview.innerHTML = html || '<span style="color: var(--text-muted);">Aucun contenu</span>';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATISTICS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateStats() {
    // Count filled fields
    let filledFields = 0;
    let totalFields = 0;
    
    const countSection = (obj) => {
        Object.values(obj).forEach(v => {
            if (typeof v === 'string') {
                totalFields++;
                if (v.trim()) filledFields++;
            }
        });
    };
    
    ['domino', 'profil', 'fleur', 'arbre', 'pourquoi', 'swot', 'pestel', 'tdc', 'pouvoir', 'cibles', 'message', 'evaluation'].forEach(section => {
        countSection(state[section]);
    });
    
    document.getElementById('stat-fields').textContent = filledFields;
    document.getElementById('stat-actors').textContent = state.acteurs.length;
    document.getElementById('stat-objectives').textContent = state.smart.length;
    document.getElementById('stat-journal').textContent = state.journal.length;
    
    // Phase progress
    const voirFields = ['domino.vision', 'profil.motivations', 'fleur.identites'];
    const jugerFields = ['arbre.probleme', 'swot.forces', 'pestel.politique', 'tdc.impact'];
    const agirFields = ['pouvoir.avec', 'cibles.principale', 'message.accroche'];
    
    const calcProgress = (fields) => {
        let filled = 0;
        fields.forEach(f => {
            const [section, key] = f.split('.');
            if (state[section]?.[key]?.trim()) filled++;
        });
        return Math.round((filled / fields.length) * 100);
    };
    
    const voirProgress = calcProgress(voirFields);
    const jugerProgress = calcProgress(jugerFields);
    const agirProgress = calcProgress(agirFields);
    const globalProgress = Math.round((voirProgress + jugerProgress + agirProgress) / 3);
    
    document.getElementById('progress-voir').textContent = voirProgress + '%';
    document.getElementById('progress-voir-bar').style.width = voirProgress + '%';
    document.getElementById('progress-juger').textContent = jugerProgress + '%';
    document.getElementById('progress-juger-bar').style.width = jugerProgress + '%';
    document.getElementById('progress-agir').textContent = agirProgress + '%';
    document.getElementById('progress-agir-bar').style.width = agirProgress + '%';
    document.getElementById('global-progress').textContent = globalProgress + '%';
    document.getElementById('global-progress-bar').style.width = globalProgress + '%';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EXPORT FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function exportProject(format) {
    const filename = (state.project.name || 'plaidoyer').replace(/[^a-z0-9]/gi, '_').toLowerCase();
    
    switch (format) {
        case 'json':
            downloadFile(JSON.stringify(state, null, 2), `${filename}.json`, 'application/json');
            break;
            
        case 'md':
            downloadFile(generateMarkdown(), `${filename}.md`, 'text/markdown');
            break;
            
        case 'html':
            downloadFile(generateHTML(), `${filename}.html`, 'text/html');
            break;
            
        case 'pdf':
            await generatePDF(filename);
            break;
            
        case 'docx':
            await generateDOCX(filename);
            break;
            
        case 'xlsx':
            generateXLSX(filename);
            break;
    }
    
    showToast(`Export ${format.toUpperCase()} rÃ©ussi`, 'success');
}

function generateMarkdown() {
    let md = `# ${state.project.name || 'Projet de Plaidoyer Citoyen'}\n\n`;
    md += `*ExportÃ© le ${new Date().toLocaleDateString('fr-FR')}*\n\n`;
    md += `**Organisation:** ${state.project.organization || 'Non dÃ©finie'}\n\n`;
    md += `${state.project.description || ''}\n\n`;
    md += `---\n\n`;
    
    // Phase VOIR
    md += `## ğŸ‘ï¸ Phase VOIR â€” Analyse de la situation\n\n`;
    md += `### ğŸ¯ Vision (Domino)\n\n${state.domino.vision || '*Non renseignÃ©*'}\n\n`;
    md += `**Obstacles:** ${state.domino.obstacles || '*Non renseignÃ©*'}\n\n`;
    md += `**Ressources:** ${state.domino.ressources || '*Non renseignÃ©*'}\n\n`;
    
    // Phase JUGER
    md += `## âš–ï¸ Phase JUGER â€” Analyse stratÃ©gique\n\n`;
    md += `### ğŸŒ³ Arbre Ã  problÃ¨mes\n\n`;
    md += `**ProblÃ¨me central:** ${state.arbre.probleme || '*Non renseignÃ©*'}\n\n`;
    md += `**Causes:** ${state.arbre.causes || '*Non renseignÃ©*'}\n\n`;
    md += `**Effets:** ${state.arbre.effets || '*Non renseignÃ©*'}\n\n`;
    
    md += `### ğŸ“ Analyse SWOT\n\n`;
    md += `| Forces | Faiblesses |\n|--------|------------|\n`;
    md += `| ${state.swot.forces || '-'} | ${state.swot.faiblesses || '-'} |\n\n`;
    md += `| OpportunitÃ©s | Menaces |\n|--------------|----------|\n`;
    md += `| ${state.swot.opportunites || '-'} | ${state.swot.menaces || '-'} |\n\n`;
    
    // Acteurs
    if (state.acteurs.length > 0) {
        md += `### ğŸ‘¥ Acteurs cartographiÃ©s\n\n`;
        state.acteurs.forEach(a => {
            const posEmoji = a.position === 'ally' ? 'ğŸŸ¢' : a.position === 'opponent' ? 'ğŸ”´' : 'ğŸŸ¡';
            md += `- ${posEmoji} **${a.name}** (${a.role}) â€” Pouvoir: ${'â˜…'.repeat(a.power)}${'â˜†'.repeat(5-a.power)}\n`;
        });
        md += '\n';
    }
    
    // Phase AGIR
    md += `## âœŠ Phase AGIR â€” Passage Ã  l'action\n\n`;
    md += `### ğŸ’¬ Message clÃ©\n\n`;
    md += `**Accroche:** ${state.message.accroche || '*Non renseignÃ©*'}\n\n`;
    md += `**ProblÃ¨me:** ${state.message.probleme || '*Non renseignÃ©*'}\n\n`;
    md += `**Appel Ã  l'action:** ${state.message.action || '*Non renseignÃ©*'}\n\n`;
    
    // Objectifs SMART
    if (state.smart.length > 0) {
        md += `### ğŸ“‹ Objectifs SMART\n\n`;
        state.smart.forEach((o, i) => {
            md += `${i+1}. ${o.completed ? '~~' : ''}${o.objective}${o.completed ? '~~' : ''} (Ã‰chÃ©ance: ${o.deadline || 'Non dÃ©finie'})\n`;
        });
        md += '\n';
    }
    
    return md;
}

function generateHTML() {
    return `<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${escapeHtml(state.project.name || 'Projet de Plaidoyer')}</title>
    <style>
        body { font-family: system-ui, sans-serif; max-width: 900px; margin: 0 auto; padding: 2rem; background: #f8fafc; color: #1e293b; line-height: 1.6; }
        h1 { color: #1a365d; border-bottom: 3px solid #d69e2e; padding-bottom: 0.5rem; }
        h2 { color: #234876; margin-top: 2rem; border-left: 4px solid #d69e2e; padding-left: 1rem; }
        h3 { color: #4a5568; margin-top: 1.5rem; }
        .card { background: white; padding: 1.5rem; border-radius: 8px; margin-bottom: 1rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .badge { display: inline-block; padding: 0.25rem 0.75rem; border-radius: 100px; font-size: 0.8rem; font-weight: 600; }
        .badge-ally { background: #c6f6d5; color: #2f855a; }
        .badge-neutral { background: #e2e8f0; color: #4a5568; }
        .badge-opponent { background: #fed7d7; color: #c53030; }
        .meta { color: #718096; font-size: 0.9rem; }
        table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
        th, td { padding: 0.75rem; border: 1px solid #e2e8f0; text-align: left; }
        th { background: #f7fafc; }
    </style>
</head>
<body>
    <h1>âš–ï¸ ${escapeHtml(state.project.name || 'Projet de Plaidoyer Citoyen')}</h1>
    <p class="meta">ExportÃ© le ${new Date().toLocaleDateString('fr-FR')} | ${escapeHtml(state.project.organization || '')}</p>
    <p>${escapeHtml(state.project.description || '')}</p>
    
    <h2>ğŸ‘ï¸ Phase VOIR</h2>
    <div class="card">
        <h3>ğŸ¯ Vision</h3>
        <p>${escapeHtml(state.domino.vision) || '<em>Non renseignÃ©</em>'}</p>
    </div>
    
    <h2>âš–ï¸ Phase JUGER</h2>
    <div class="card">
        <h3>ğŸŒ³ ProblÃ¨me central</h3>
        <p>${escapeHtml(state.arbre.probleme) || '<em>Non renseignÃ©</em>'}</p>
    </div>
    
    ${state.acteurs.length > 0 ? `
    <div class="card">
        <h3>ğŸ‘¥ Acteurs</h3>
        ${state.acteurs.map(a => `
            <span class="badge badge-${a.position}">${escapeHtml(a.name)}</span>
        `).join(' ')}
    </div>
    ` : ''}
    
    <h2>âœŠ Phase AGIR</h2>
    <div class="card">
        <h3>ğŸ’¬ Message clÃ©</h3>
        <p><strong>${escapeHtml(state.message.accroche) || ''}</strong></p>
        <p>${escapeHtml(state.message.probleme) || ''}</p>
        <p><em>${escapeHtml(state.message.importance) || ''}</em></p>
        <p><strong>â†’ ${escapeHtml(state.message.action) || ''}</strong></p>
    </div>
</body>
</html>`;
}

async function generatePDF(filename) {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    
    // Title
    doc.setFontSize(20);
    doc.setTextColor(26, 54, 93);
    doc.text(state.project.name || 'Projet de Plaidoyer Citoyen', 20, 20);
    
    doc.setFontSize(10);
    doc.setTextColor(100);
    doc.text(`ExportÃ© le ${new Date().toLocaleDateString('fr-FR')}`, 20, 28);
    
    let y = 40;
    
    // Vision
    doc.setFontSize(14);
    doc.setTextColor(26, 54, 93);
    doc.text('Vision', 20, y);
    y += 8;
    
    doc.setFontSize(10);
    doc.setTextColor(50);
    const visionLines = doc.splitTextToSize(state.domino.vision || 'Non renseignÃ©', 170);
    doc.text(visionLines, 20, y);
    y += visionLines.length * 5 + 10;
    
    // ProblÃ¨me central
    doc.setFontSize(14);
    doc.setTextColor(26, 54, 93);
    doc.text('ProblÃ¨me central', 20, y);
    y += 8;
    
    doc.setFontSize(10);
    doc.setTextColor(50);
    const problemLines = doc.splitTextToSize(state.arbre.probleme || 'Non renseignÃ©', 170);
    doc.text(problemLines, 20, y);
    y += problemLines.length * 5 + 10;
    
    // Acteurs
    if (state.acteurs.length > 0) {
        doc.setFontSize(14);
        doc.setTextColor(26, 54, 93);
        doc.text('Acteurs', 20, y);
        y += 8;
        
        doc.setFontSize(10);
        state.acteurs.forEach(a => {
            const pos = a.position === 'ally' ? '[AlliÃ©]' : a.position === 'opponent' ? '[Opposant]' : '[Neutre]';
            doc.text(`${pos} ${a.name} - ${a.role}`, 20, y);
            y += 6;
            if (y > 270) { doc.addPage(); y = 20; }
        });
    }
    
    // Message
    y += 5;
    doc.setFontSize(14);
    doc.setTextColor(26, 54, 93);
    doc.text('Message clÃ©', 20, y);
    y += 8;
    
    doc.setFontSize(10);
    doc.setTextColor(50);
    if (state.message.accroche) {
        doc.setFont(undefined, 'bold');
        doc.text(state.message.accroche, 20, y);
        doc.setFont(undefined, 'normal');
        y += 6;
    }
    if (state.message.action) {
        doc.text(`â†’ ${state.message.action}`, 20, y);
    }
    
    doc.save(`${filename}.pdf`);
}

async function generateDOCX(filename) {
    const { Document, Paragraph, TextRun, HeadingLevel, Packer } = docx;
    
    const doc = new Document({
        sections: [{
            children: [
                new Paragraph({
                    text: state.project.name || 'Projet de Plaidoyer Citoyen',
                    heading: HeadingLevel.TITLE
                }),
                new Paragraph({
                    children: [
                        new TextRun({ text: `ExportÃ© le ${new Date().toLocaleDateString('fr-FR')}`, italics: true, color: '666666' })
                    ]
                }),
                new Paragraph({ text: '' }),
                
                new Paragraph({ text: 'Phase VOIR â€” Vision', heading: HeadingLevel.HEADING_1 }),
                new Paragraph({ text: state.domino.vision || 'Non renseignÃ©' }),
                new Paragraph({ text: '' }),
                
                new Paragraph({ text: 'Phase JUGER â€” ProblÃ¨me central', heading: HeadingLevel.HEADING_1 }),
                new Paragraph({ text: state.arbre.probleme || 'Non renseignÃ©' }),
                new Paragraph({ text: '' }),
                
                new Paragraph({ text: 'Acteurs', heading: HeadingLevel.HEADING_2 }),
                ...state.acteurs.map(a => new Paragraph({
                    children: [
                        new TextRun({ text: `â€¢ ${a.name}`, bold: true }),
                        new TextRun({ text: ` (${a.role}) â€” ${a.position === 'ally' ? 'AlliÃ©' : a.position === 'opponent' ? 'Opposant' : 'Neutre'}` })
                    ]
                })),
                new Paragraph({ text: '' }),
                
                new Paragraph({ text: 'Phase AGIR â€” Message clÃ©', heading: HeadingLevel.HEADING_1 }),
                new Paragraph({
                    children: [new TextRun({ text: state.message.accroche || '', bold: true })]
                }),
                new Paragraph({ text: state.message.probleme || '' }),
                new Paragraph({
                    children: [new TextRun({ text: `â†’ ${state.message.action || ''}`, bold: true })]
                })
            ]
        }]
    });
    
    const blob = await Packer.toBlob(doc);
    downloadBlob(blob, `${filename}.docx`);
}

function generateXLSX(filename) {
    const wb = XLSX.utils.book_new();
    
    // Feuille RÃ©sumÃ©
    const summaryData = [
        ['Projet de Plaidoyer Citoyen'],
        [''],
        ['Nom du projet', state.project.name || ''],
        ['Organisation', state.project.organization || ''],
        ['Description', state.project.description || ''],
        ['Date crÃ©ation', state.project.created || ''],
        ['Ã‰chÃ©ance', state.project.deadline || ''],
        [''],
        ['PHASE VOIR'],
        ['Vision', state.domino.vision || ''],
        ['Obstacles', state.domino.obstacles || ''],
        ['Ressources', state.domino.ressources || ''],
        [''],
        ['PHASE JUGER'],
        ['ProblÃ¨me central', state.arbre.probleme || ''],
        ['Forces', state.swot.forces || ''],
        ['Faiblesses', state.swot.faiblesses || ''],
        ['OpportunitÃ©s', state.swot.opportunites || ''],
        ['Menaces', state.swot.menaces || ''],
        [''],
        ['PHASE AGIR'],
        ['Message accroche', state.message.accroche || ''],
        ['Appel Ã  action', state.message.action || '']
    ];
    const wsSummary = XLSX.utils.aoa_to_sheet(summaryData);
    XLSX.utils.book_append_sheet(wb, wsSummary, 'RÃ©sumÃ©');
    
    // Feuille Acteurs
    if (state.acteurs.length > 0) {
        const actorsData = [
            ['Nom', 'RÃ´le', 'Position', 'Pouvoir'],
            ...state.acteurs.map(a => [a.name, a.role, a.position, a.power])
        ];
        const wsActors = XLSX.utils.aoa_to_sheet(actorsData);
        XLSX.utils.book_append_sheet(wb, wsActors, 'Acteurs');
    }
    
    // Feuille Objectifs SMART
    if (state.smart.length > 0) {
        const smartData = [
            ['Objectif', 'Indicateur', 'Ã‰chÃ©ance', 'ComplÃ©tÃ©'],
            ...state.smart.map(o => [o.objective, o.indicator, o.deadline, o.completed ? 'Oui' : 'Non'])
        ];
        const wsSmart = XLSX.utils.aoa_to_sheet(smartData);
        XLSX.utils.book_append_sheet(wb, wsSmart, 'Objectifs SMART');
    }
    
    // Feuille Journal
    if (state.journal.length > 0) {
        const journalData = [
            ['Date', 'Type', 'Contenu'],
            ...state.journal.map(e => [e.date, e.type, e.content])
        ];
        const wsJournal = XLSX.utils.aoa_to_sheet(journalData);
        XLSX.utils.book_append_sheet(wb, wsJournal, 'Journal');
    }
    
    XLSX.writeFile(wb, `${filename}.xlsx`);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// IMPORT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function importProject(event) {
    const file = event.target.files[0];
    if (!file) return;
    
    const reader = new FileReader();
    reader.onload = (e) => {
        try {
            const imported = JSON.parse(e.target.result);
            state = { ...state, ...imported };
            populateFields();
            renderActors();
            renderSmartObjectives();
            renderJournal();
            updateStats();
            saveState(false);
            showToast('Projet importÃ© avec succÃ¨s', 'success');
        } catch (err) {
            showToast('Erreur: fichier JSON invalide', 'error');
        }
    };
    reader.readAsText(file);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UTILITIES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showToast(message, type = 'success') {
    const container = document.getElementById('toast-container');
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    toast.innerHTML = `<span>${type === 'success' ? 'âœ“' : type === 'error' ? 'âœ•' : 'â„¹'}</span><span>${message}</span>`;
    container.appendChild(toast);
    
    setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transform = 'translateX(100%)';
        setTimeout(() => toast.remove(), 300);
    }, 3000);
}

function downloadFile(content, filename, type) {
    const blob = new Blob([content], { type: type + ';charset=utf-8' });
    downloadBlob(blob, filename);
}

function downloadBlob(blob, filename) {
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = filename;
    a.click();
    URL.revokeObjectURL(url);
}

function escapeHtml(str) {
    if (!str) return '';
    return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
}

function debounce(fn, ms) {
    let timeout;
    return (...args) => {
        clearTimeout(timeout);
        timeout = setTimeout(() => fn(...args), ms);
    };
}
    </script>
</body>
</html>
